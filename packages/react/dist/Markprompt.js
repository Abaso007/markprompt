import n,{useCallback as A,useEffect as y,useRef as h,useState as m}from"react";import M from"classnames";import K from"remark-gfm";import T from"react-markdown";import{submitPrompt as z}from"@markprompt/core";const D=()=>n.createElement("span",{className:"caret animate-caret inline-block h-[15px] w-[8px] translate-y-[2px] translate-x-[2px] transform rounded-[1px] bg-fuchsia-500 shadow-[0_0px_3px_0px_rgba(217,70,219,0.9)]"}),o=({Component:s,children:l,...t})=>(s==="code"&&t.inline&&(t={...t,inline:"true"}),n.createElement(s,{...t,className:"markdown-node"},l,n.createElement(D,null))),L=({model:s,projectKey:l,iDontKnowMessage:t,placeholder:P,autoScrollDisabled:g,didCompleteFirstQuery:p,onDark:v,completionsUrl:b})=>{const[i,S]=m(void 0),[r,x]=m(""),[d,w]=m([]),[a,C]=m(!1),u=h(null),f=h(null),k=h(!1),N=t||"Sorry, I am not sure how to answer that.",E=P||"Ask me anything...",I=A(async e=>{e.preventDefault(),i&&(x(""),w([]),C(!0),await z(i,l,c=>x(_=>_+c),c=>w(c),{completionsUrl:b,iDontKnowMessage:N,model:s}),C(!1))},[i,l,b,N,s]);return y(()=>{if(g||!u.current||!f.current)return;const e=f.current.getBoundingClientRect();u.current.scrollTop=e.bottom},[r,a,g,d]),y(()=>{!a&&r.length>0&&(k.current||(k.current=!0,p==null||p()))},[a,r,p]),n.createElement("div",{className:"relative flex h-full flex-col"},n.createElement("div",{className:"h-12 border-b border-neutral-900"},n.createElement("form",{onSubmit:I},n.createElement("input",{value:i||"",type:"text",onChange:e=>S(e.target.value),placeholder:E,className:"w-full appearance-none rounded-md border-0 bg-transparent px-0 pt-1 pb-2 outline-none placeholder:text-neutral-500 focus:outline-none focus:ring-0",autoComplete:"off",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false",autoFocus:!0}))),n.createElement("div",{className:M("absolute inset-x-0 bottom-0 z-10 h-10 bg-gradient-to-t",{"from-neutral-1000 to-neutral-1000/0":!v,"from-neutral-1100 to-neutral-1100/0":v})}),n.createElement("div",{ref:u,className:"hidden-scrollbar prose prose-sm absolute inset-x-0 bottom-0 top-12 z-0 max-w-full overflow-y-auto scroll-smooth py-4 pb-8 dark:prose-invert"},a&&!(r.length>0)&&n.createElement(D,null),n.createElement("div",{className:M("prompt-answer",{"prompt-answer-done":!a,"prompt-answer-loading":a})},n.createElement(T,{components:{p:e=>n.createElement(o,{Component:"p",...e}),span:e=>n.createElement(o,{Component:"span",...e}),h1:e=>n.createElement(o,{Component:"h1",...e}),h2:e=>n.createElement(o,{Component:"h2",...e}),h3:e=>n.createElement(o,{Component:"h3",...e}),h4:e=>n.createElement(o,{Component:"h4",...e}),h5:e=>n.createElement(o,{Component:"h5",...e}),h6:e=>n.createElement(o,{Component:"h6",...e}),pre:e=>n.createElement(o,{Component:"pre",...e}),code:e=>n.createElement(o,{Component:"code",...e}),td:e=>n.createElement(o,{Component:"td",...e})},remarkPlugins:[K]},r)),r.length>0&&d.length>0&&n.createElement("div",{className:"mt-8 border-t border-neutral-900 pt-4 text-sm text-neutral-500"},n.createElement("div",{className:"animate-slide-up"},"Summary generated from the following sources:",n.createElement("div",{className:"mt-4 flex w-full flex-row flex-wrap items-center gap-2"},d.map(e=>n.createElement("div",{key:`reference-${e}`,className:"cursor-pointer rounded-md border border-neutral-900 bg-neutral-1100 px-2 py-1 text-sm font-medium text-neutral-300 transition hover:border-neutral-800 hover:text-neutral-200"},e))))),n.createElement("div",{className:"h-8"}),n.createElement("div",{ref:f})))};var j=L;export{L as Markprompt,j as default};
